my code
some fixes
new code in master
